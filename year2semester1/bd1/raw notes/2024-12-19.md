---
created: 2024-12-19
done ?: "- [ ]"
updated: 2024-12-19T13:54
---
**passo 1**: crea un grafo diretto (con archi diretti)$G$ (grafo di serializzazione)
- nodi: transazioni
- archi: $T_{i} \to T_{j}$ (con etichetta $X$) se in $S$, $T_i$ esegue un `unlock(X)` e $T_j$ esegue il successivo `lock(X)` (non un successivo, ma **IL** successivo, cioè $T_j$)

**passo 2**: se $G$ ha un cliclo allora $S$ non è serializzabile, altrimenti applicando a G l’ordinamento topologico

grafo aciclico, grafo ciclico

dato che il grafo è diretto, per avere un ciclo devono esserci archi, che creano un ciclo, tutti nella stessa direzione

ordinamento topologico:
parto eliminando ricorsivamente i nodi che non hanno archi entrranti, eliminando i suoi archi uscenti

uno schedule S è serializzabile $\iff$ il suo garfo di serializzazione è aciclico

anche t1 t5 t3 t4 e un ciclo (slide 41)
ordinamento topologico si può fare solo su grafi aciclici (altrimenti, a un certo punto si blocca)

## protocollo di locking a 2 fasi
diverso da protocollo a 2 valori !!!
una transazione obbedisce al protocollo di locking a due fasi (è a 2 fasi) se:
- prima effettua tutte le operazioni di lock
- poi tutte le operazioni di unlock
## teorema sul lock a 2 fasi
sia $T$ un insieme di transazioni. 
se ogni transazione in $T$ è a 2 fasi, allora ogni schedule di $T$ è serializzabile

dimostazione per assurdo 
ogni transazione in $S$ è a 2 fasi ma nel grafo di serializzazione c’è un ciclo